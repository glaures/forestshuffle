import{c as R,g as W}from"./unhead-CBj6-SSQ.js";import{n as U,v as B,i as N,u as $,r as H,a as V,w as q,o as F,b as K,e as G,g as j}from"./@vue-JyELclcM.js";function J(e){return Array.isArray(e)?e:[e]}const k=["title","titleTemplate","script","style","noscript"],A=["base","meta","link","style","script","noscript"],z=["title","titleTemplate","templateParams","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"],Q=["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"],S=["tagPosition","tagPriority","tagDuplicateStrategy","children","innerHTML","textContent","processTemplateParams"],pe=typeof window<"u";function ye(e){return e}function X(e){let n=9;for(let t=0;t<e.length;)n=Math.imul(n^e.charCodeAt(t++),9**9);return((n^n>>>9)+65536).toString(16).substring(1,8).toLowerCase()}function P(e){return e._h||X(e._d?e._d:`${e.tag}:${e.textContent||e.innerHTML||""}:${Object.entries(e.props).map(([n,t])=>`${n}:${String(t)}`).join(",")}`)}function Y(e,n){const{props:t,tag:o}=e;if(Q.includes(o))return o;if(o==="link"&&t.rel==="canonical")return"canonical";if(t.charset)return"charset";const r=["id"];o==="meta"&&r.push("name","property","http-equiv");for(const s of r)if(typeof t[s]<"u"){const l=String(t[s]);return`${o}:${s}:${l}`}return!1}function me(e,n){return e==null?n||null:typeof e=="function"?e(n):e}async function Z(e,n,t){const o={tag:e,props:await L(typeof n=="object"&&typeof n!="function"&&!(n instanceof Promise)?{...n}:{[["script","noscript","style"].includes(e)?"innerHTML":"textContent"]:n},["templateParams","titleTemplate"].includes(e))};return S.forEach(r=>{const s=typeof o.props[r]<"u"?o.props[r]:t[r];typeof s<"u"&&((!["innerHTML","textContent","children"].includes(r)||k.includes(o.tag))&&(o[r==="children"?"innerHTML":r]=s),delete o.props[r])}),o.props.body&&(o.tagPosition="bodyClose",delete o.props.body),o.tag==="script"&&typeof o.innerHTML=="object"&&(o.innerHTML=JSON.stringify(o.innerHTML),o.props.type=o.props.type||"application/json"),Array.isArray(o.props.content)?o.props.content.map(r=>({...o,props:{...o.props,content:r}})):o}function ee(e,n){var o;const t=e==="class"?" ":";";return typeof n=="object"&&!Array.isArray(n)&&(n=Object.entries(n).filter(([,r])=>r).map(([r,s])=>e==="style"?`${r}:${s}`:r)),(o=String(Array.isArray(n)?n.join(t):n))==null?void 0:o.split(t).filter(r=>r.trim()).filter(Boolean).join(t)}async function L(e,n){for(const t of Object.keys(e)){if(["class","style"].includes(t)){e[t]=ee(t,e[t]);continue}if(e[t]instanceof Promise&&(e[t]=await e[t]),!n&&!S.includes(t)){const o=String(e[t]),r=t.startsWith("data-");o==="true"||o===""?e[t]=r?"true":!0:e[t]||(r&&o==="false"?e[t]="false":delete e[t])}}return e}const te=10;async function he(e){const n=[];return Object.entries(e.resolvedInput).filter(([t,o])=>typeof o<"u"&&z.includes(t)).forEach(([t,o])=>{const r=J(o);n.push(...r.map(s=>Z(t,s,e)).flat())}),(await Promise.all(n)).flat().filter(Boolean).map((t,o)=>(t._e=e._i,e.mode&&(t._m=e.mode),t._p=(e._i<<te)+o,t))}const _={base:-10,title:10},C={critical:-80,high:-10,low:20};function ge(e){let n=100;const t=e.tagPriority;return typeof t=="number"?t:(e.tag==="meta"?(e.props["http-equiv"]==="content-security-policy"&&(n=-30),e.props.charset&&(n=-20),e.props.name==="viewport"&&(n=-15)):e.tag==="link"&&e.props.rel==="preconnect"?n=20:e.tag in _&&(n=_[e.tag]),typeof t=="string"&&t in C?n+C[t]:n)}const be=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}],Te=["onload","onerror","onabort","onprogress","onloadstart"],g="%separator";function ne(e,n,t){if(typeof e!="string"||!e.includes("%"))return e;function o(l){let u;return["s","pageTitle"].includes(l)?u=n.pageTitle:l.includes(".")?u=l.split(".").reduce((b,p)=>b&&b[p]||void 0,n):u=n[l],typeof u<"u"?(u||"").replace(/"/g,'\\"'):!1}let r=e;try{r=decodeURI(e)}catch{}return(r.match(/%(\w+\.+\w+)|%(\w+)/g)||[]).sort().reverse().forEach(l=>{const u=o(l.slice(1));typeof u=="string"&&(e=e.replace(new RegExp(`\\${l}(\\W|$)`,"g"),(b,p)=>`${u}${p}`).trim())}),e.includes(g)&&(e.endsWith(g)&&(e=e.slice(0,-g.length).trim()),e.startsWith(g)&&(e=e.slice(g.length).trim()),e=e.replace(new RegExp(`\\${g}\\s*\\${g}`,"g"),g),e=ne(e,{separator:t},t)),e}async function oe(e,n={}){var w;const t=n.document||e.resolvedOptions.document;if(!t||!e.dirty)return;const o={shouldRender:!0,tags:[]};if(await e.hooks.callHook("dom:beforeRender",o),!o.shouldRender)return;const r=(await e.resolveTags()).map(i=>({tag:i,id:A.includes(i.tag)?P(i):i.tag,shouldRender:!0}));let s=e._dom;if(!s){s={elMap:{htmlAttrs:t.documentElement,bodyAttrs:t.body}};for(const i of["body","head"]){const a=(w=t[i])==null?void 0:w.children,d=[];for(const f of[...a].filter(c=>A.includes(c.tagName.toLowerCase()))){const c={tag:f.tagName.toLowerCase(),props:await L(f.getAttributeNames().reduce((y,T)=>({...y,[T]:f.getAttribute(T)}),{})),innerHTML:f.innerHTML};let m=1,h=Y(c);for(;h&&d.find(y=>y._d===h);)h=`${h}:${m++}`;c._d=h||void 0,d.push(c),s.elMap[f.getAttribute("data-hid")||P(c)]=f}}}s.pendingSideEffects={...s.sideEffects||{}},s.sideEffects={};function l(i,a,d){const f=`${i}:${a}`;s.sideEffects[f]=d,delete s.pendingSideEffects[f]}function u({id:i,$el:a,tag:d}){const f=d.tag.endsWith("Attrs");s.elMap[i]=a,f||(["textContent","innerHTML"].forEach(c=>{d[c]&&d[c]!==a[c]&&(a[c]=d[c])}),l(i,"el",()=>{var c;(c=s.elMap[i])==null||c.remove(),delete s.elMap[i]}));for(const[c,m]of Object.entries(d._eventHandlers||{}))a.getAttribute(`data-${c}`)!==""&&((d.tag==="bodyAttrs"?t.defaultView:a).addEventListener(c.replace("on",""),m.bind(a)),a.setAttribute(`data-${c}`,""));Object.entries(d.props).forEach(([c,m])=>{const h=`attr:${c}`;if(c==="class")for(const y of(m||"").split(" ").filter(Boolean))f&&l(i,`${h}:${y}`,()=>a.classList.remove(y)),!a.classList.contains(y)&&a.classList.add(y);else if(c==="style")for(const y of(m||"").split(";").filter(Boolean)){const[T,...I]=y.split(":").map(D=>D.trim());l(i,`${h}:${T}`,()=>{a.style.removeProperty(T)}),a.style.setProperty(T,I.join(":"))}else a.getAttribute(c)!==m&&a.setAttribute(c,m===!0?"":String(m)),f&&l(i,h,()=>a.removeAttribute(c))})}const b=[],p={bodyClose:void 0,bodyOpen:void 0,head:void 0};for(const i of r){const{tag:a,shouldRender:d,id:f}=i;if(d){if(a.tag==="title"){t.title=a.textContent;continue}i.$el=i.$el||s.elMap[f],i.$el?u(i):A.includes(a.tag)&&b.push(i)}}for(const i of b){const a=i.tag.tagPosition||"head";i.$el=t.createElement(i.tag.tag),u(i),p[a]=p[a]||t.createDocumentFragment(),p[a].appendChild(i.$el)}for(const i of r)await e.hooks.callHook("dom:renderTag",i,t,l);p.head&&t.head.appendChild(p.head),p.bodyOpen&&t.body.insertBefore(p.bodyOpen,t.body.firstChild),p.bodyClose&&t.body.appendChild(p.bodyClose),Object.values(s.pendingSideEffects).forEach(i=>i()),e._dom=s,e.dirty=!1,await e.hooks.callHook("dom:rendered",{renders:r})}async function re(e,n={}){const t=n.delayFn||(o=>setTimeout(o,10));return e._domUpdatePromise=e._domUpdatePromise||new Promise(o=>t(async()=>{await oe(e,n),delete e._domUpdatePromise,o()}))}function ve(e){return n=>{var o,r;const t=((r=(o=n.resolvedOptions.document)==null?void 0:o.head.querySelector('script[id="unhead:payload"]'))==null?void 0:r.innerHTML)||!1;return t&&n.push(JSON.parse(t)),{mode:"client",hooks:{"entries:updated":function(s){re(s,e)}}}}}const x=B.startsWith("3");function ie(e){return typeof e=="function"?e():$(e)}function v(e,n=""){if(e instanceof Promise)return e;const t=ie(e);return!e||!t?t:Array.isArray(t)?t.map(o=>v(o,n)):typeof t=="object"?Object.fromEntries(Object.entries(t).map(([o,r])=>o==="titleTemplate"||o.startsWith("on")?[o,$(r)]:[o,v(r,o)])):t}const se={hooks:{"entries:resolve":function(e){for(const n of e.entries)n.resolvedInput=v(n.input)}}},O="usehead";function ae(e){return{install(t){x&&(t.config.globalProperties.$unhead=e,t.config.globalProperties.$head=e,t.provide(O,e))}}.install}function Ae(e={}){e.domDelayFn=e.domDelayFn||(t=>U(()=>setTimeout(()=>t(),0)));const n=R(e);return n.use(se),n.install=ae(n),n}const E=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},M="__unhead_injection_handler__";function ce(){return M in E?E[M]():N(O)||W()}function le(e,n={}){const t=n.head||ce();if(t)return t.ssr?t.push(e,n):fe(t,e,n)}function fe(e,n,t={}){const o=H(!1),r=H({});V(()=>{r.value=o.value?{}:v(n)});const s=e.push(r.value,t);return q(r,u=>{s.patch(u)}),j()&&(F(()=>{s.dispose()}),K(()=>{o.value=!0}),G(()=>{o.value=!1})),s}const we={created(){let e=!1;if(x){const n=j();if(!n)return;const t=n.type;if(!t||!("head"in t))return;e=typeof t.head=="function"?()=>t.head.call(n.proxy):t.head}else{const n=this.$options.head;n&&(e=typeof n=="function"?()=>n.call(this):n)}e&&le(e)}};export{ve as D,A as H,pe as I,Te as N,be as S,we as V,Y as a,Ae as c,ye as d,X as h,he as n,ne as p,me as r,ge as t};
